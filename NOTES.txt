# keyboard -> pynput 변경 고려




버전 업데이트하기 이전 체크리스트

- 디버깅용 코드 주석처리
- 데이터 버전 확인
- 버전확인 쓰레드 활성화
- AFK기능 활성화
- 데이터 버전 및 호환 여부 확인
- 버전 확인
- VirusTotal 확인
- README 파일 업데이트


pyinstaller -F -w --clean -i="./resource/icon.ico" --add-data "resource;resource" SkillMacro.py
pyinstaller -w --clean -i="./resource/icon.ico" --add-data "resource;resource" SkillMacro.py

pyinstaller -F -w --clean -i="./app/resources/image/icon.ico" --add-data "app;app" SkillMacro.py
pyinstaller -w --clean -i="./app/resources/image/icon.ico" --add-data "app;app" SkillMacro.py


pyinstaller --upx-dir "upx" -F -w --clean -i="./app/resources/image/icon.ico" --add-data "app;app" SkillMacro.py
pyinstaller --upx-dir "upx" -w --clean -i="./app/resources/image/icon.ico" --add-data "app;app" SkillMacro.py

# 기본
pyinstaller -F -w --clean -i="./app/resources/image/icon.ico" --add-data "app;app" SkillMacro.py

# optimize 옵션
pyinstaller -F -w --clean -i="./app/resources/image/icon.ico" --add-data "app;app" --optimize 2 SkillMacro.py

# optimize & upx
pyinstaller --upx-dir "upx" -F -w --clean -i="./app/resources/image/icon.ico" --add-data "app;app" --optimize 2 SkillMacro.py

upx를 사용하지 않는 것도 고려해야함.
upx때문에 실행 속도가 느려지고, 바이러스로 오탐될 가능성이 증가할 수 있음.

python==3.12.3
pyinstaller==6.9.0
(onefile은 2, installer는 0이지만 설치하면 6)

6.9.0은 실행이 안됨. 6.16.0으로 업그레이드
=> 3/71

pip install -r requirements.txt

pip freeze > requirements_temp.txt
pip uninstall -r requirements_temp.txt -y

데이터 버전
1 : 3.0.0 ~ 3.0.1
2 : 3.1.0 ~


   1      2      3      4      0   
#E57373#F44336#EF9A9A#FF8A65#EF9A9A
#81C784#2196F3#90CAF9#81D4FA#90CAF9
#64B5F6#FFEB3B#A5D6A7#80CBC4#A5D6A7
#BA68C8#4CAF50#FFF59D#FFD54F#FFEB3B
#FFD54F#FF9800#CE93D8#B39DDB#CE93D8
#4DB6AC#9C27B0#FFCC80#FFAB91#FFA386

전투력
#F38181#FCE38A#A7E6FF#95E1D3

#####
직업
#A0DEFF#FED0E9#ffa0a0#DFCCFB#FFCF96#97E7E1#CAF4FF#DCBFFF

전사류: 검호 / 매화
도적류: 살수 / 도제
법사류 : 술사 / 도사
궁수류 : 빙궁 / 귀궁
#####
* 직업 시스템에서 무기 수집형으로 바뀔 가능성 높음


--------
todo:

제공되는 스킬 정보 사용 / 직접 쿨타임을 입력 하는 모드 바꿀 수 있게
연계스킬을 하나의 스킬로 취급하여 설정에 띄우고, 우선순위를 변경할 수 있도록 변경

Mojang API를 이용해서 직접 계정으로 로그인 후 로그인 검증을 람다에서 수행
- 위키피디아에 파이썬 라이브러리가 있음.

마크가 관리자 권한으로 실행돼있으면 매크로가 키보드, 마우스 입력을 못함.

스킬 아이콘을 포함시켜서 배포하거나 다운로드 받는 것은 문제가 될 수 있음.
=> 공격/버프 스킬 아이콘을 따로 만들어서 인게임 스킬 아이콘을 대체.

sidebar2의 스킬들을 장착한 스킬들만 표시되도록 변경

딜레이에 따라 전투력이 바뀌는 현상을 제거해야함. (매크로와 별개로 스탯만을 이용해서 전투력 계산)
일반몹, 보스 내공에 따라 전투력이 바뀌는 현상을 제거해야함. (내공 고려x 또는 몇가지 경우에 따라 전투력 계산)

스킬 사용설정 -> 스킬 사용 여부 X라면 우선순위 제거하도록 수정

게임 창을 캡쳐해서 잠재능력과 같은 아이템 정보를 감지해서 자동 입력

화면을 표시할 때 모든 위젯을 생성/삭제하는 과정에서 QStackedWidget으로 페이지를 만들어서 관리하는 방식으로 변경

Sim2에서 마우스가 그래프 밖에 있을 때 모든 그래프의 mouseEvent를 호출하도록 설정

누적 피해량 그래프의 60초 최대 데미지가 다른 그래프와 다른 현상 수정

그래프 기능들(툴팁, 그리드 등) 통일 및 코드 정리

link_skill 클래스 생성

pyqtgraph에서 마우스를 빠르게 이동시켜 annotation 위에 마우스가 올라가면 annotation 업데이트가 안됨.

시뮬레이션에서 결정론적인 수치들 계산하고, 나머지는 실시간으로 그래프 그리기

누적 피해량에 스킬별로 색 채운 그래프

QColorDialog 이용 -> 아이콘 색 변경

python flag.optimize, pyinstaller optimize

절대 좌표 방식 -> QHBoxLayout, QVBoxLayout, QGridLayout으로 변경

코드를 수정하지 않고 json 파일만 수정하면 서버, 스킬 데이터 모두 변하게 수정(기본값, 목록 등을 json에 포함)

프로그램 내 기본 정보가 변경되었을 때 LocalAppdata의 데이터와 다르면 발생하는 오류 수정하기

스킬 쿨타임이 레벨에 따라 조절될 수 있도록 수정

보스 체력과 제한 시간을 입력해서 제한 시간 내에 처치할 수 있는지, 처치 배율을 표시

서버 정보를 shared_data에 저장하지 말고, 서버 정보를 저장하는 클래스를 만들어 사용하기
config.py

모듈 레벨 싱글톤:
"""
# shared_data.py 파일 내용
class ProgramState:
    def __init__(self):
        self.count = 0
        ...
STATE_MANAGER = ProgramState()

# 다른 파일
from shared_data import STATE_MANAGER
STATE_MANAGER.count += 10
"""
=> 프로그램 전역에서 이 데이터를 공유함.

그래프를 그리고 스크롤 할 때 렉이 걸린다면 캐시를 쓰는 방법 검토

---------



데미지공식: 표기데미지 X (정확한 숫자는 아님, 공격력 <-> 파괴력 바뀌었을수도)
베이스 - 파괴력 * (공격력 * 0.005 + 1) * 직업계수 * 내공계수
임시   - 공격력 * (근력 + 지력) * (1 + 파괴력 * 0.01) * 내공계수

데미지감소1 = 방어력 * 0.5 + 체력 * 경도 * 0.001 = 50 + 50

* 회복량 가정 *
자연회복 = 5초당 10%
포션회복 = 2초당 300
초당 회복량 = 체력 * 자연회복 * 0.2 + 포션회복 * 0.5 = 40 + 150 = 190


보스데미지 - [ 데미지(내공, 보뎀) ]
시뮬레이션 데미지 * (1 + 보스데미지 * 0.01) * 1.0

일반데미지 - [ 데미지(내공) ]
시뮬레이션 데미지 * 1.2

보스

1 - [ 데미지(내공, 보뎀) * (체력 + 피격횟수 * 뎀감 + 시간 * 초당회복량) / (1 - 회피율)  ]
=> 데미지 * 체력

2 - [ 데미지(내공, 보뎀) * (뎀감 + 초당회복량) / (1 - 회피율)  ]
=> 데미지 * 초당 버틸 수 있는 체력
: 입는 피해가 회복하는 피해보다 크면 유지가 불가능, 회복량에 체력이 포함되어있음.

3 - [ 데미지(내공, 보뎀) * 체력 * (뎀감 + 초당회복량) / (1 - 회피율)  ]
=> 데미지 * 체력 * 초당 버틸 수 있는 체력
: 회복량이 동일하더라도 체력이 증가하면 강해지므로, 2번에서 체력을 추가적으로 고려하도록 변경

4 - [ 데미지(내공, 보뎀) * 체력^0.5 * (뎀감 + 초당회복량) / (1 - 회피율)  ]
=> 데미지 * 체력^0.5 * 초당 버틸 수 있는 체력
: 3번은 체력의 영향력이 너무 강하여 루트를 씌워 체력의 영향력을 낮춤. 제곱하는 수는 이후 수정해야함.
- 체력 100당 4.0%, 방어력 10당 1.7%, 포션회복량 10당 5%, 경도 10당 6.7%

5 - [ 데미지(내공, 보뎀) * (체력 + 뎀감 * 5 + 초당회복량 * 5) / (1 - 회피율)  ]
=> 데미지 * (5초동안 초당 한 번씩 피해를 입는다는 가정에서의 버틸 수 있는 체력)
: 4번은 데미지감소 관련 스탯의 영향력이 너무 강하여, 체력과 합침으로써 영향력을 줄임.
- 체력 100당 3.5%, 방어력 10당 0.7%, 포션회복량 10당 2.2%, 경도 5당 1.4%

보스데미지 * (체력 * 방어력 * 경도 * 0.0000001 + (체력 * 자연회복율 + (1 + 포션회복 * 0.01) * 300) * 0.001) * (1 + 회피 * 0.01) * 0.7

사냥  -  [ 데미지(내공) * 경험치 * 운 * 상태이상저항 ]
일반데미지 * (1 + 운 * 0.01) * (1 + 상태이상저항 * 0.001) * (1 + 경험치 * 0.01) * 0.8


공격력	     100
방어력	     100
파괴력	     25
근력	        150
지력	        150
경도	        25
치확	        50
치뎀	        50
보스데미지 	  20
명중률        20
회피율	     20
상태이상저항   25
신속          10
체력	        2200
공격속도	      20
포션회복	      5
운             30
경험치	      5

데미지		보스데미지		일반데미지		보스		사냥	
58593.75		70312.5		70312.5		69925.78125		69682.9834	




#시뮬레이션

## 캐릭터 정보
### 스텟
### 스킬레벨

## 시뮬레이터
### 전투력
1. 보스데미지
2. 일반데미지
3. 보스
4. 사냥

### 수치 분석 - min, max, std(표준편차), p25, p50, p75
1. 초당 피해량
2. 총 피해량
(3. 초당 회복량)
(4. 총 회복량)

### 그래프 분석
1. DPM 분포 (1)
2. 스킬 DPS (연계스킬 포함, 원) (1)
3. 시간 경과에 따른 피해량 (2)
4. 누적 피해량 (2)
5. 스킬별 누적 기여도 (2)


## 스탯 계산기
### 스펙업 효율 계산기
### 추가 스펙업 계산기
### 잠재능력 계산기
### 잠재능력 옵션 순위표


## 캐릭터 카드
### 닉네임
### 캐릭터 선택
### 캐릭터 이미지
- 닉네임
- 직업
- 전투력



# 스텟 종류

공격력
방어력
파괴력
근력
지력
*경도
*치확 0.25
*치뎀 0.25
*보스데미지 0.25
명중률
회피율 0.25
*상태이상저항
내공  # 100까지
*체력
*공격속도(쿨타임)
*포션회복
*운
경험치획득량

+ *신속
+ 레벨
+ 몬스터 내공

*는 잠재능력에 포함될 가능성 높은 옵션

내공 - 공격력에 관여 1당 1은아님
경도 - 방어력에 관여 마찬가지로 1당 1은아님
체력 - 1당 1인데 방어력 높을수록 이 수치도 높아짐



QComboBox를 사용할 때는
"[i.show() for i in self.page2.findChildren(QWidget)]"
을 사용하면 안되고 각 위젯에 대하여 .show()를 일일이 실행시켜야함